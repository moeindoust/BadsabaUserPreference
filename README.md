<div align="center">

# 📊 پروژه سیستم توصیه‌گر تبلیغات بادصبا
### (BadSaba Targeted Advertising)
پروژه پیش‌بینی ترجیحات کاربران براساس رفتار و ارائه بنر های تبلیغات با هدف افزایش نرخ کلیلک روی بنر ها ، با مقایسه مدل‌های TF-IDF و ParsBERT در تبدیل متن بنر به بردار

</div>

---

## 🎯 ۱. درباره پروژه

پروژه بادصبا یک چالش در حوزه **تبلیغات هدفمند (Targeted Advertising)** است که در قالب هکتون هوش مصنوعی در دانشگاه فردوسی مشهد مطرح شد. هدف اصلی، طراحی سیستمی است که با نمایش محتوای تبلیغاتی مناسب به هر کاربر، تعامل و نرخ تبدیل (کلیک بر بنر) را به حداکثر برساند. برای رسیدن به این هدف، از یکی از قدرتمندترین روش‌ها در سیستم‌های توصیه‌گر، یعنی **فیلترینگ مشارکتی (Collaborative Filtering)**، استفاده شده است. این روش بر این فرض استوار است که «کاربرانی با رفتار مشابه در گذشته، در آینده نیز علایق مشترکی خواهند داشت.»

فرضیه اصلی این پروژه این است که می‌توان کاربران را بر اساس رفتارشان در اپلیکیشن، به **خوشه‌های معنایی (Semantic Clusters)** تقسیم کرد. در این پروژه، بیش از ۳۰۰ هزار کاربر از قبل در ۵۰۰ خوشه دسته‌بندی شده‌اند و هر کاربر با یک بردار ۸ بعدی در یک فضای معنایی نمایش داده می‌شود. از سوی دیگر، بنرهای تبلیغاتی نیز باید از طریق تحلیل متن کپشن‌هایشان به بردارهای عددی (Embeddings) تبدیل شوند تا معنای آن‌ها برای مدل قابل درک باشد.

بنابراین، هدف نهایی، طراحی یک **مدل رگرسیون** است که با دریافت بردار نماینده یک خوشه کاربری و بردار معنایی یک بنر، بتواند **میزان علاقه‌مندی (Preference Score)** آن خوشه به آن بنر را با دقت بالا پیش‌بینی کند و به این سوال که **««به کدام کاربر ، کدام بنر را نشان دهم؟»»**
پاسخ بدهد.

---

<div dir="rtl">

### ۲. اطلاعات دیتاست
دیتاست ارائه شده شامل اطلاعات بیش از ۳۰۰ هزار کاربر است که بر اساس رفتارشان در **۵۰۰ خوشه معنایی (Segment)** دسته‌بندی شده‌اند. وظیفه اصلی، پیش‌بینی میزان علاقه هر خوشه به بنرهای تبلیغاتی مختلف است.

| نام ویژگی (Feature) | توضیحات |
| :--- | :--- |
| **User Vectors** | نمایش هر کاربر در یک فضای معنایی ۸ بعدی. |
| **Segment Array** | تخصیص هر کاربر به یکی از ۵۰۰ خوشه معنایی. |
| **Banner Captions** | کپشن‌های متنی و فارسی بنرهای تبلیغاتی. |
| **p_train / p_test** | داده‌های آموزشی و تست شامل جفت‌های (خوشه، بنر) و امتیاز علاقه (`p`). |

**نکته مهم:** تحلیل اکتشافی ما در این پروژه نشان داد که خوشه‌های کاربری از پیش مهندسی شده، دارای قدرت پیش‌بینی بسیار بالایی هستند که این موضوع، چالش اصلی پروژه را تحت تأثیر قرار داد.

</div>

---

## ⚙️ ۳. فرآیند پروژه
در این پروژه، یک پایپ‌لاین کامل از تحلیل تا مقایسه مدل‌های پیشرفته پیاده‌سازی شده است:

### الف) تحلیل اکتشافی داده‌ها (EDA)
در این مرحله مشخص شد که بردارهای ۸ بعدی خوشه‌های کاربری، سیگنال بسیار قوی‌ای برای پیش‌بینی امتیاز علاقه دارند. این یافته، استراتژی مدل‌سازی ما را تحت تأثیر قرار داد.

### ب) مهندسی ویژگی و پیش‌پردازش
برای آماده‌سازی داده‌ها، دو رویکرد متفاوت برای تبدیل متن بنرها به بردار عددی پیاده‌سازی و مقایسه شد:
1.  **روش آماری (TF-IDF):** یک روش کلاسیک و سریع برای تبدیل متن به بردار بر اساس فرکانس کلمات کلیدی.
2.  **روش مبتنی بر مدل زبانی (ParsBERT):** یک مدل ترنسفورمر پیشرفته که معنای کلمات را در بافت جمله درک کرده و بردارهای معنایی عمیق‌تری تولید می‌کند.

### ج) مدل‌سازی
برای هر دو رویکرد بالا، از یک مدل **LightGBM Regressor** برای پیش‌بینی امتیاز نهایی استفاده شد تا بتوانیم تأثیر کیفیت بردارهای بنر را به صورت منصفانه مقایسه کنیم.

---

## 🚀 ۴. نتایج و مقایسه نهایی
پس از اجرای هر دو پایپ‌لاین، نتایج زیر به دست آمد. نکته شگفت‌انگیز، عملکرد تقریباً یکسان هر دو روش بود:

| روش Embedding | MAE (خطای میانگین مطلق) | R2 Score | امتیاز نهایی مسابقه |
| :--- | :---: | :---: | :---: |
| **TF-IDF (روش ساده)** | **0.0010** | **0.7560** | **0.0997** |
| ParsBERT (روش پیشرفته) | 0.0010 | 0.7577 | 0.1013 |

**تحلیل نتایج:** عملکرد تقریباً یکسان دو مدل نشان می‌دهد که ویژگی‌های مربوط به **خوشه‌های کاربری** به قدری قدرتمند هستند که بخش عمده‌ای از کار پیش‌بینی را انجام می‌دهند. در این حالت، بهبود بیشتر روی کیفیت بردارهای بنر (استفاده از ParsBERT) تأثیر معناداری بر نتیجه نهایی ندارد.

**نتیجه‌گیری کسب‌وکار:** با توجه به عملکرد یکسان، مدل مبتنی بر **TF-IDF** به دلیل **سرعت بسیار بالاتر، هزینه محاسباتی کمتر و سادگی پیاده‌سازی**، گزینه ارجح و بهینه برای این پروژه است.

---

## 💡 ۵. ابزارها و تکنولوژی‌ها

<div align="center">
  <img alt="Python" src="https://img.shields.io/badge/Python-3776AB?style=for-the-badge&logo=python&logoColor=white"/>
  <img alt="Pandas" src="https://img.shields.io/badge/Pandas-150458?style=for-the-badge&logo=pandas&logoColor=white"/>
  <img alt="scikit-learn" src="https://img.shields.io/badge/scikit--learn-F7931E?style=for-the-badge&logo=scikit-learn&logoColor=white"/>
  <img alt="LightGBM" src="https://img.shields.io/badge/LightGBM-992F64?style=for-the-badge&logo=lightgbm&logoColor=white"/>
  <img alt="Transformers" src="https://img.shields.io/badge/Transformers-4051B5?style=for-the-badge&logo=huggingface&logoColor=white"/>
  <img alt="PyTorch" src="https://img.shields.io/badge/PyTorch-EE4C2C?style=for-the-badge&logo=pytorch&logoColor=white"/>
  <img alt="Matplotlib" src="https://img.shields.io/badge/Matplotlib-11557C?style=for-the-badge&logo=matplotlib&logoColor=white"/>
  <img alt="Seaborn" src="https://img.shields.io/badge/Seaborn-5A7BA7?style=for-the-badge&logo=seaborn&logoColor=white"/>
</div>

---

## 🚀 ۶. نحوه اجرا و پیش‌نیازها

**پیش‌نیازها:**
- پایتون (Python 3.7+)
- کتابخانه‌های لیست شده در فایل `requirements.txt`

**مراحل اجرا:**

۱. **کلون کردن ریپازیتوری:**
```bash
git clone https://github.com/moeindoust/Badsaba-Ad-Recommender.git
cd Badsaba-Ad-Recommender
```

۲. **نصب کتابخانه‌های مورد نیاز:**
```bash
pip install -r requirements.txt
```

۳.**اجرای پایپ‌لاین:**
برای اجرای کامل هر دو فرآیند و مشاهده نتایج، دستور زیر را در ترمینال وارد کنید:
```bash
python run_pipeline.py
```


**ساختار ریپازیتوری:**
```bash
├── data/
│   ├── raw/
│   │   └── (All original csv, npy, and txt files...)
│   └── processed/
│       └── (Processed data ready for modeling...)
│
├── outputs/
│   ├── figures/
│   │   └── (Saved EDA plots and charts...)
│   └── submissions/
│       └── submission.csv
│
├── src/
│   ├── __init__.py
│   ├── config.py
│   ├── data_processing.py
│   ├── feature_engineering.py
│   └── train_evaluate.py
│
├── .gitignore
├── README.md
├── requirements.txt
└── run_pipeline.py
```

**توسعه‌دهنده:**  
[moeindoust](https://github.com/moeindoust)
